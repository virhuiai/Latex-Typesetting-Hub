
 \section{Processing options\hfill 处理选项}\label{sec:process}
 
% \input{geometry_处理选项_加载顺序.tex}
% \input{geometry_处理选项_选项的顺序.tex}

\columnratio{0.55}
\begin{paracol}{2}
\subsection{Priority}\label{sec:priority}

There are several ways to set dimensions of the \gpart{body}:
|scale|, |total|, |text| and |lines|. The \Gm\ package gives higher
priority to the more concrete specification. Here is the priority
rule for \gpart{body}.

\switchcolumn
\subsection{优先级}

有多种方式可以设置\gpart{正文}的尺寸：|scale|、|total|、|text| 和 |lines|。
\Gm\ 宏包对更具体的规格给予更高的优先级。以下是\gpart{正文}的优先级规则。

\switchcolumn[0]*
 \[\begin{array}{c}
 \textrm{priority:}\qquad\textrm{low}\quad
    \longrightarrow\quad\textrm{high}\\[1em]
 \left\{\begin{array}{l}|hscale|\\|vscale|\\|scale|
        \end{array}\right\} <
 \left\{\begin{array}{l}|width|\\|height|\\|total|
        \end{array}\right\} <
 \left\{\begin{array}{l}|textwidth|\\|textheight|
         \\|text|\end{array}\right\} < |lines|.
 \end{array}\]

\switchcolumn
 \[\begin{array}{c}
 \textrm{优先级:}\qquad\textrm{低}\quad
    \longrightarrow\quad\textrm{高}\\[1em]
 \left\{\begin{array}{l}|hscale|\\|vscale|\\|scale|
        \end{array}\right\} <
 \left\{\begin{array}{l}|width|\\|height|\\|total|
        \end{array}\right\} <
 \left\{\begin{array}{l}|textwidth|\\|textheight|
         \\|text|\end{array}\right\} < |lines|.
 \end{array}\]


 \switchcolumn[0]*
 For example, 
 \begin{quote}
  |\usepackage[hscale=0.8, textwidth=7in, width=18cm]{geometry}|
 \end{quote}
\switchcolumn
例如，
\begin{quote}
\begin{minted}{latex}
\usepackage[hscale=0.8, textwidth=7in, width=18cm]{geometry}
\end{minted}    
\end{quote}

\switchcolumn[0]*
is the same as |\usepackage[textwidth=7in]{geometry}|. Another example:
\begin{quote}
|\usepackage[lines=30, scale=0.8, text=7in]{geometry}|
\end{quote}
\switchcolumn
等同于 |\usepackage[textwidth=7in]{geometry}|。另一个例子：
\begin{quote}
\begin{minted}{latex}
\usepackage[lines=30, scale=0.8, text=7in]{geometry}
\end{minted}    
\end{quote}
\switchcolumn[0]
results in \texttt{[lines=30, textwidth=7in]}.
\switchcolumn
的结果是 \texttt{[lines=30, textwidth=7in]}.
\end{paracol}

\columnratio{0.55}
\begin{paracol}{2}

 \subsection{Defaults}\label{sec:defaults}

 This section sums up the default settings for the auto-completion
 described later.
 
 The default vertical margin ratio is $2/3$, namely,
 \begin{equation}
  |top| : |bottom| = 2 : 3 \qquad\textit{default}.
 \end{equation}
 As for the horizontal margin ratio, the default value depends on
 whether the document is onesided or twosided,
 \begin{equation}
  |left|\;(|inner|) : |right|\;(|outer|) 
       = \left\{ \begin{array}{ll}
              1 : 1 \qquad\textit{default for oneside},\\
              2 : 3 \qquad\textit{default for twoside}.
         \end{array}\right.
 \end{equation}
 Obviously the default horizontal margin ratio for oneside is `centering'.

 The \Gm\ package has the following default setting for
 \textit{onesided} documents:
 \begin{itemize}\setlength{\itemsep}{-.5\parsep}
  \item |scale=0.7| (\gpart{body} is $0.7 \times \gpart{paper}$)
  \item |marginratio={1:1, 2:3}| (1:1 for horizontal and 2:3 for vertical margins)
  \item |ignoreall| (the header, footer, marginal notes are excluded
  when calculating the size of \gpart{body}.)
\end{itemize}
 For \textit{twosided} document with |twoside| option, the default
 setting is the same as \textit{onesided} except that the horizontal
 margin ratio is set to |2:3| as well.

 Additional options overwrite the previous specified dimensions. 

\end{paracol}



 \subsection{Auto-completion} \label{sec:rules}

 Figure~\ref{fig:specrule} shows schematically how many specification
 patterns exist and how to solve the ambiguity of the
 specifications. Each axis shows the numbers of lengths
 explicitly specified for body and margins. \Ss($m$,$b$) presents the
 specification with a set of numbers $(\gpart{margin},\gpart{body})=(m,b)$.

 For example, the specification |width=14cm, left=3cm| is categorized
 into \Ss(1,1), which is an adequate specification. If you add
 |right=4cm|, it would be in \Ss(2,1) and overspecified. 
 If only |width=14cm| is given, it's in \Ss(0,1), underspecified. 

 The \Gm\ package has the auto-completion mechanism, in which
 if the layout parameters are underspecified or overspecified,
 \Gm\ works out the ambiguity using the defaults and other
 relations. Here are the specifications and the completion rules.

 \begin{figure}
  \centering
  {\unitlength=1pt
  \begin{picture}(400,150)(40,0)
  \put(1,49){\makebox(90,49)[r]{\large 0}}
  \put(1,1){\makebox(70,99)[r]{\large \gpart{body}}}
  \put(1,1){\makebox(90,49)[r]{\large 1}}
  \put(100,100){\makebox(99,20){\large 0}}
  \put(100,50){\framebox(99,49){}}
  \put(100,80){\makebox(99,15){\Ss(0,0)}}
  \put(100,50){\makebox(99,49){use |scale|}}
  {\linethickness{1pt}%
  \put(150,35){\line(0,1){30}}
  \put(150,35){\line(-1,3){4}}
  \put(150,35){\line(1,3){4}}}
  \put(100,0){\framebox(99,49){}}
  \put(100,2){\makebox(99,15){\Ss(0,1)}}
  \put(100,0){\makebox(99,49){use |marginratio|}}
  \put(200,120){\makebox(99,12){\large \gpart{margin}}}
  \put(200,100){\makebox(99,20){\large 1}}
  \put(200,50){\framebox(99,49){use |scale|}}
  \put(200,55){\makebox(89,10)[r]{\scriptsize\shortstack[l]{if |ratio|\\specified}}}
  \put(200,2){\makebox(99,15){\Ss(1,1)}}
  {\linethickness{1pt}%
  \put(250,35){\line(0,1){30}}
  \put(250,35){\line(-1,3){4}}
  \put(250,35){\line(1,3){4}}}
  {\linethickness{1pt}%
  \put(225,25){\line(-1,0){35}}
  \put(225,25){\line(-3,-1){12}}
  \put(225,25){\line(-3,1){12}}}
  \put(200,80){\makebox(99,15){\Ss(1,0)}}
  \put(200,0){\framebox(99,49){\textcolor{red}{\textit{solvable}}}}
  \put(300,100){\makebox(99,20){\large 2}}
  \put(300,80){\makebox(99,15){\Ss(2,0)}}
  \put(300,50){\framebox(99,49){\textcolor{red}{\textit{solvable}}}}
  \put(300,0){\framebox(99,49){forget |body|}}
  \put(300,2){\makebox(99,15){\Ss(2,1)}}
  {\linethickness{1pt}%
  \multiput(290,65)(5,0){6}{\line(1,0){3}}
  \put(320,65){\line(-3,-1){12}}
  \put(320,65){\line(-3,1){12}}}
  {\linethickness{1pt}%
  \put(350,65){\line(0,-1){30}}
  \put(350,65){\line(-1,-3){4}}
  \put(350,65){\line(1,-3){4}}}
  \end{picture}}
  \caption[Specifications and completion rules]{%
  \begin{minipage}[t]{.7\textwidth}\raggedright\small
  Specifications \Ss(0,0) to \Ss(2,1) and the completion rules
  (arrows). Column and row numbers denote the number of explicitly
  specified lengths for margin and body respectively. \Ss($m$,$b$) denote a
  specification with a set of the numbers $(\gpart{margin},\gpart{body})=(m,b)$. 
  \end{minipage}}
  \label{fig:specrule}
 \end{figure}

 \begin{Spec}
\columnratio{0.55}
\begin{paracol}{2}
\switchcolumn[0]*\item[\Ss(0,0)]
 Nothing is specified. The \Gm\ package sets \gpart{body} with the
 default |scale| ($=0.7$). \\ For example, |width| is set to be
 $|0.7|\times|layoutwidth|$. Note that by default |layoutwidth| 
 and |layoutheight| will be equal to |\paperwidth| and |\paperheight|
 respectively.
 Thus \Ss(0,0) goes to \Ss(0,1). See \Ss(0,1).
 \bigskip

 \switchcolumn
\switchcolumn[0]*\item[\Ss(0,1)]
 Only \gpart{body} is specified, such as |width=7in|, |lines=20|,
 |body={20cm,24cm}|, |scale=0.9| and so forth.
 Then \Gm\ sets margins with the margin ratio.
 If the margin ratio is not specified, the default is used.
 The default vertical margin ratio is defined as
 \begin{equation}
  |top| : |bottom| = 2 : 3 \qquad\textit{default}.
 \end{equation}
 As for the horizontal margin ratio, the default value depends on
 whether the document is onesided or twosided,
 \begin{equation}
  |left|\;(|inner|) : |right|\;(|outer|) 
       = \left\{ \begin{array}{ll}
              1 : 1 \qquad\textit{default for oneside},\\
              2 : 3 \qquad\textit{default for twoside}.
         \end{array}\right.
 \end{equation}
 For example, if |height=22cm| is specified on A4 paper, 
 \Gm\ calculates |top| margin as follows:
 \begin{equation}
   \begin{array}{ll}
   |top| &= ( |layoutheight| - |height| ) \times 2/5 \\
         &= (29.7-22)\times2/5 = 3.08\textrm{(cm)}
   \end{array}
 \end{equation}
 Thus |top| margin and body |height| have been determined, the
 specification for the vertical goes to \Ss(1,1) and
 all the parameters can be solved.
 \bigskip

 \switchcolumn
\switchcolumn[0]*\item[\Ss(1,0)]
 Only one margin is specified, such as |bottom=2cm|, |left=1in|,
 |top=3cm|, and so forth.

 \begin{itemize}
 \switchcolumn
\switchcolumn[0]*\item \textbf{If the margin ratio is \textit{not} specified}, \Gm\ sets
 \gpart{body} with the default |scale| ($=0.7$). 
 For example, if |top=2.4cm| is specified, \Gm\ sets
 \begin{center}
     $|height|= |0.7|\times|layoutheight|$ 
            ~~($=|0.7\paperheight|$ by default),
 \end{center}
 then \Ss(1,0) goes to \Ss(1,1), in which |bottom| is calculated
 with $|layoutheight|-(|height|+|top|)$ and results in 6.51cm on A4
 paper if the layout size is equal to the paper size.
 \medskip
 \switchcolumn
\switchcolumn[0]*\item \textbf{If the margin ratio is specified}, such as
 |hmarginratio={1:2}|, |vratio={3:4}| and so forth,
 \Gm\ sets the other% margin with the specified margin ratio.
 For example, if a set of options ``|top=2.4cm,vratio={3:4}|'' is
 specified, \Gm\ sets |bottom| to be |3.2cm| calculating
 \begin{center}
     $|bottom|= |top|/3\times4 = 3.2\textrm{cm}$
 \end{center}
 Thus \Ss(1,0) goes to \Ss(2,0).
 \end{itemize}

 Note that the version 4 or earlier used to set the other margin
 with the margin ratio. In the version 5, therefore, with the
 same specification, the result will be different from the one in the
 version 4. For example, if only |top=2.4cm| is specified, 
 you got |bottom=2.4cm| in the version 4 or earlier, but you will get
 |bottom=6.51cm| in the version 5.
 \bigskip

 \switchcolumn
\switchcolumn[0]*\item[\Ss(2,1)]
 The \gpart{body} and two \gpart{margins} are all specified, such as
  |vdivide={1in,8in,1.5in}|, ``|left=3cm,width=13cm,right=4cm|'' and
  so forth. Since \Gm\ basically gives priority to \gpart{margins}
  if dimensions are overspecified, \Gm\ forgets and resets
  \gpart{body}. For example, if you specify
 \begin{center}
    |\usepackage[a4paper,left=3cm,width=13cm,right=4cm]{geometry}|,
 \end{center}
 |width| is reset to be 14cm because the width of a A4 paper is 21cm
 long.
\end{paracol}
 \end{Spec}
