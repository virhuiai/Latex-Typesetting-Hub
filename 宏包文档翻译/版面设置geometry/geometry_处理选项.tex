
 \section{Processing options\hfill 处理选项}\label{sec:process}
 
 \columnratio{0.55}
\begin{paracol}{2}
\subsection{Order of loading}\label{sec:loadorder}

If there's |geometry.cfg| somewhere \TeX{} can find it, \Gm\ loads
it first. For example, in |geometry.cfg| you may write
|\ExecuteOptions{a4paper}|, which specifies A4 paper as the default
paper. Basically you can use all the options defined in \Gm\ with
|\ExecuteOptions{}|.

The order of loading in the preamble of your document is as follows:
\switchcolumn

\subsection{加载顺序}\label{sec:loadorder}

如果\TeX{}能找到|geometry.cfg|文件，\Gm\ 会首先加载它。例如，在|geometry.cfg|文件中，您可以写上|\ExecuteOptions{a4paper}|，这将把A4纸设置为默认纸张。基本上，您可以使用\Gm\ 中定义的所有选项与|\ExecuteOptions{}|一起使用。

在您的文档的导言部分加载的顺序如下：
\end{paracol}

\begin{enumerate}
\columnratio{0.55}
\begin{paracol}{2}
\switchcolumn[0]*\item |geometry.cfg| if it exists.
\switchcolumn \item 如果存在|geometry.cfg|，加载之。
\switchcolumn[0]*\item Options specified with |\documentclass[|\meta{options}|]{...}|.
\switchcolumn \item 使用|\documentclass[|\meta{options}|]{...}|指定的选项。
\switchcolumn[0]*\item Options specified with |\usepackage[|\meta{options}|]{geometry}|
\switchcolumn \item 使用|\usepackage[|\meta{options}|]{geometry}|指定的选项。
\switchcolumn[0]*\item Options specified with |\geometry{|\meta{options}|}|, which
can be called multiple times. (|reset| option will cancel the
specified options ever given in  |\usepackage{geometry}| or
|\geometry|.)
\switchcolumn
\item 使用|\geometry{|\meta{options}|}|指定的选项，可以多次调用。（|reset|选项将取消在|\usepackage{geometry}|或|\geometry|中指定的选项。）
\end{paracol}
\end{enumerate}

\columnratio{0.55}
\begin{paracol}{2}
\subsection{Order of options}\label{sec:optionorder}

The specification of \Gm\ options is order-independent,
and overwrites the previous one for the same setting.
For example, 
\switchcolumn
\subsection{选项的顺序}

\Gm\ 选项的指定是无序的，并且会覆盖先前相同设置的选项。
例如，

\switchcolumn[0]*
\begin{center}
|[left=2cm, right=3cm]| is equivalent to 
|[right=3cm, left=2cm]|.
\end{center}
\switchcolumn
\begin{center}
|[left=2cm, right=3cm]| 等同于
|[right=3cm, left=2cm]|.
\end{center}

\switchcolumn[0]*
 The options called multiple times overwrite the previous
 settings. For example, 
 \begin{center}
  |[verbose=true, verbose=false]| results in |verbose=false|. 
 \end{center}
 |[hmargin={3cm,2cm}, left=1cm]| is the same as |hmargin={1cm,2cm}|, 
where the left (or inner) margin is overwritten by |left=1cm|. 
\switchcolumn
多次调用的选项会覆盖先前的设置。例如，
\begin{center}
|[verbose=true, verbose=false]| 的结果是 |verbose=false|。
\end{center}
|[hmargin={3cm,2cm}, left=1cm]| 等同于 |hmargin={1cm,2cm}|，其中左侧（或内侧）边距被 |left=1cm| 覆盖。        

\switchcolumn[0]*
 |reset| and |mag| are exceptions.
 The |reset| option removes all the geometry options (except |pass|)
 before it. If you set
 \begin{quote}
 |\documentclass[landscape]{article}|\\
 |\usepackage[margin=1cm,twoside]{geometry}|\\
 |\geometry{a5paper, reset, left=2cm}|
 \end{quote}
\switchcolumn
|reset| 和 |mag| 是例外。
|reset| 选项会在其之前删除所有的几何选项（除了 |pass|）。如果您设置
\begin{quote}
|\documentclass[landscape]{article}|\\
|\usepackage[margin=1cm,twoside]{geometry}|\\
|\geometry{a5paper, reset, left=2cm}|
\end{quote}

\switchcolumn[0]*
 then |margin=1cm|, |twoside| and |a5paper| are removed, and 
 is eventually equivalent to
 \begin{quote}
 |\documentclass[landscape]{article}|\\
 |\usepackage[left=2cm]{geometry}|
 \end{quote}
 \switchcolumn
 那么 |margin=1cm|、|twoside| 和 |a5paper| 被删除，并最终等同于
\begin{quote}
|\documentclass[landscape]{article}|\\
|\usepackage[left=2cm]{geometry}|
\end{quote}
\switchcolumn[0]*
 The |mag| option should be set in advance of any other settings with
 `true' length, such as |left=1.5truecm|, |width=5truein| and so on.
 The |\mag| primitive can be set before this package is called.
\switchcolumn
|mag| 选项应该在任何其他带有 `true' 长度的设置之前进行设置，例如 |left=1.5truecm|、|width=5truein| 等等。
|\mag| 原语可以在调用此宏包之前进行设置。

\end{paracol}




 \subsection{Priority}\label{sec:priority}
  
 There are several ways to set dimensions of the \gpart{body}:
 |scale|, |total|, |text| and |lines|. The \Gm\ package gives higher
 priority to the more concrete specification. Here is the priority
 rule for \gpart{body}.
 \[\begin{array}{c}
 \textrm{priority:}\qquad\textrm{low}\quad
    \longrightarrow\quad\textrm{high}\\[1em]
 \left\{\begin{array}{l}|hscale|\\|vscale|\\|scale|
        \end{array}\right\} <
 \left\{\begin{array}{l}|width|\\|height|\\|total|
        \end{array}\right\} <
 \left\{\begin{array}{l}|textwidth|\\|textheight|
         \\|text|\end{array}\right\} < |lines|.
 \end{array}\]
 For example, 
 \begin{quote}
  |\usepackage[hscale=0.8, textwidth=7in, width=18cm]{geometry}|
 \end{quote}
 is the same as |\usepackage[textwidth=7in]{geometry}|. Another example:
 \begin{quote}
  |\usepackage[lines=30, scale=0.8, text=7in]{geometry}|
 \end{quote}
 results in \texttt{[lines=30, textwidth=7in]}.

 \subsection{Defaults}\label{sec:defaults}

 This section sums up the default settings for the auto-completion
 described later.
 
 The default vertical margin ratio is $2/3$, namely,
 \begin{equation}
  |top| : |bottom| = 2 : 3 \qquad\textit{default}.
 \end{equation}
 As for the horizontal margin ratio, the default value depends on
 whether the document is onesided or twosided,
 \begin{equation}
  |left|\;(|inner|) : |right|\;(|outer|) 
       = \left\{ \begin{array}{ll}
              1 : 1 \qquad\textit{default for oneside},\\
              2 : 3 \qquad\textit{default for twoside}.
         \end{array}\right.
 \end{equation}
 Obviously the default horizontal margin ratio for oneside is `centering'.

 The \Gm\ package has the following default setting for
 \textit{onesided} documents:
 \begin{itemize}\setlength{\itemsep}{-.5\parsep}
  \item |scale=0.7| (\gpart{body} is $0.7 \times \gpart{paper}$)
  \item |marginratio={1:1, 2:3}| (1:1 for horizontal and 2:3 for vertical margins)
  \item |ignoreall| (the header, footer, marginal notes are excluded
  when calculating the size of \gpart{body}.)
\end{itemize}
 For \textit{twosided} document with |twoside| option, the default
 setting is the same as \textit{onesided} except that the horizontal
 margin ratio is set to |2:3| as well.

 Additional options overwrite the previous specified dimensions. 

 \subsection{Auto-completion} \label{sec:rules}

 Figure~\ref{fig:specrule} shows schematically how many specification
 patterns exist and how to solve the ambiguity of the
 specifications. Each axis shows the numbers of lengths
 explicitly specified for body and margins. \Ss($m$,$b$) presents the
 specification with a set of numbers $(\gpart{margin},\gpart{body})=(m,b)$.

 For example, the specification |width=14cm, left=3cm| is categorized
 into \Ss(1,1), which is an adequate specification. If you add
 |right=4cm|, it would be in \Ss(2,1) and overspecified. 
 If only |width=14cm| is given, it's in \Ss(0,1), underspecified. 

 The \Gm\ package has the auto-completion mechanism, in which
 if the layout parameters are underspecified or overspecified,
 \Gm\ works out the ambiguity using the defaults and other
 relations. Here are the specifications and the completion rules.

 \begin{figure}
  \centering
  {\unitlength=1pt
  \begin{picture}(400,150)(40,0)
  \put(1,49){\makebox(90,49)[r]{\large 0}}
  \put(1,1){\makebox(70,99)[r]{\large \gpart{body}}}
  \put(1,1){\makebox(90,49)[r]{\large 1}}
  \put(100,100){\makebox(99,20){\large 0}}
  \put(100,50){\framebox(99,49){}}
  \put(100,80){\makebox(99,15){\Ss(0,0)}}
  \put(100,50){\makebox(99,49){use |scale|}}
  {\linethickness{1pt}%
  \put(150,35){\line(0,1){30}}
  \put(150,35){\line(-1,3){4}}
  \put(150,35){\line(1,3){4}}}
  \put(100,0){\framebox(99,49){}}
  \put(100,2){\makebox(99,15){\Ss(0,1)}}
  \put(100,0){\makebox(99,49){use |marginratio|}}
  \put(200,120){\makebox(99,12){\large \gpart{margin}}}
  \put(200,100){\makebox(99,20){\large 1}}
  \put(200,50){\framebox(99,49){use |scale|}}
  \put(200,55){\makebox(89,10)[r]{\scriptsize\shortstack[l]{if |ratio|\\specified}}}
  \put(200,2){\makebox(99,15){\Ss(1,1)}}
  {\linethickness{1pt}%
  \put(250,35){\line(0,1){30}}
  \put(250,35){\line(-1,3){4}}
  \put(250,35){\line(1,3){4}}}
  {\linethickness{1pt}%
  \put(225,25){\line(-1,0){35}}
  \put(225,25){\line(-3,-1){12}}
  \put(225,25){\line(-3,1){12}}}
  \put(200,80){\makebox(99,15){\Ss(1,0)}}
  \put(200,0){\framebox(99,49){\textcolor{red}{\textit{solvable}}}}
  \put(300,100){\makebox(99,20){\large 2}}
  \put(300,80){\makebox(99,15){\Ss(2,0)}}
  \put(300,50){\framebox(99,49){\textcolor{red}{\textit{solvable}}}}
  \put(300,0){\framebox(99,49){forget |body|}}
  \put(300,2){\makebox(99,15){\Ss(2,1)}}
  {\linethickness{1pt}%
  \multiput(290,65)(5,0){6}{\line(1,0){3}}
  \put(320,65){\line(-3,-1){12}}
  \put(320,65){\line(-3,1){12}}}
  {\linethickness{1pt}%
  \put(350,65){\line(0,-1){30}}
  \put(350,65){\line(-1,-3){4}}
  \put(350,65){\line(1,-3){4}}}
  \end{picture}}
  \caption[Specifications and completion rules]{%
  \begin{minipage}[t]{.7\textwidth}\raggedright\small
  Specifications \Ss(0,0) to \Ss(2,1) and the completion rules
  (arrows). Column and row numbers denote the number of explicitly
  specified lengths for margin and body respectively. \Ss($m$,$b$) denote a
  specification with a set of the numbers $(\gpart{margin},\gpart{body})=(m,b)$. 
  \end{minipage}}
  \label{fig:specrule}
 \end{figure}

 \begin{Spec}
\columnratio{0.55}
\begin{paracol}{2}
\switchcolumn[0]*\item[\Ss(0,0)]
 Nothing is specified. The \Gm\ package sets \gpart{body} with the
 default |scale| ($=0.7$). \\ For example, |width| is set to be
 $|0.7|\times|layoutwidth|$. Note that by default |layoutwidth| 
 and |layoutheight| will be equal to |\paperwidth| and |\paperheight|
 respectively.
 Thus \Ss(0,0) goes to \Ss(0,1). See \Ss(0,1).
 \bigskip

 \switchcolumn
\switchcolumn[0]*\item[\Ss(0,1)]
 Only \gpart{body} is specified, such as |width=7in|, |lines=20|,
 |body={20cm,24cm}|, |scale=0.9| and so forth.
 Then \Gm\ sets margins with the margin ratio.
 If the margin ratio is not specified, the default is used.
 The default vertical margin ratio is defined as
 \begin{equation}
  |top| : |bottom| = 2 : 3 \qquad\textit{default}.
 \end{equation}
 As for the horizontal margin ratio, the default value depends on
 whether the document is onesided or twosided,
 \begin{equation}
  |left|\;(|inner|) : |right|\;(|outer|) 
       = \left\{ \begin{array}{ll}
              1 : 1 \qquad\textit{default for oneside},\\
              2 : 3 \qquad\textit{default for twoside}.
         \end{array}\right.
 \end{equation}
 For example, if |height=22cm| is specified on A4 paper, 
 \Gm\ calculates |top| margin as follows:
 \begin{equation}
   \begin{array}{ll}
   |top| &= ( |layoutheight| - |height| ) \times 2/5 \\
         &= (29.7-22)\times2/5 = 3.08\textrm{(cm)}
   \end{array}
 \end{equation}
 Thus |top| margin and body |height| have been determined, the
 specification for the vertical goes to \Ss(1,1) and
 all the parameters can be solved.
 \bigskip

 \switchcolumn
\switchcolumn[0]*\item[\Ss(1,0)]
 Only one margin is specified, such as |bottom=2cm|, |left=1in|,
 |top=3cm|, and so forth.

 \begin{itemize}
 \switchcolumn
\switchcolumn[0]*\item \textbf{If the margin ratio is \textit{not} specified}, \Gm\ sets
 \gpart{body} with the default |scale| ($=0.7$). 
 For example, if |top=2.4cm| is specified, \Gm\ sets
 \begin{center}
     $|height|= |0.7|\times|layoutheight|$ 
            ~~($=|0.7\paperheight|$ by default),
 \end{center}
 then \Ss(1,0) goes to \Ss(1,1), in which |bottom| is calculated
 with $|layoutheight|-(|height|+|top|)$ and results in 6.51cm on A4
 paper if the layout size is equal to the paper size.
 \medskip
 \switchcolumn
\switchcolumn[0]*\item \textbf{If the margin ratio is specified}, such as
 |hmarginratio={1:2}|, |vratio={3:4}| and so forth,
 \Gm\ sets the other% margin with the specified margin ratio.
 For example, if a set of options ``|top=2.4cm,vratio={3:4}|'' is
 specified, \Gm\ sets |bottom| to be |3.2cm| calculating
 \begin{center}
     $|bottom|= |top|/3\times4 = 3.2\textrm{cm}$
 \end{center}
 Thus \Ss(1,0) goes to \Ss(2,0).
 \end{itemize}

 Note that the version 4 or earlier used to set the other margin
 with the margin ratio. In the version 5, therefore, with the
 same specification, the result will be different from the one in the
 version 4. For example, if only |top=2.4cm| is specified, 
 you got |bottom=2.4cm| in the version 4 or earlier, but you will get
 |bottom=6.51cm| in the version 5.
 \bigskip

 \switchcolumn
\switchcolumn[0]*\item[\Ss(2,1)]
 The \gpart{body} and two \gpart{margins} are all specified, such as
  |vdivide={1in,8in,1.5in}|, ``|left=3cm,width=13cm,right=4cm|'' and
  so forth. Since \Gm\ basically gives priority to \gpart{margins}
  if dimensions are overspecified, \Gm\ forgets and resets
  \gpart{body}. For example, if you specify
 \begin{center}
    |\usepackage[a4paper,left=3cm,width=13cm,right=4cm]{geometry}|,
 \end{center}
 |width| is reset to be 14cm because the width of a A4 paper is 21cm
 long.
\end{paracol}
 \end{Spec}
