\setcounter{section}{4}
\setcounter{subsection}{11} 
\setcounter{subsubsection}{0}

% 在 LaTeX 的 tcolorbox 宏包中，Overlays 是一种强大的特性，允许你在盒子的前景或背景添加额外的图形元素。你可以使用它来创建各种复杂的效果，比如添加边框、背景图案、水印等。

% Overlays 使用的是 TikZ 语法，这意味着你可以利用 TikZ 提供的所有功能来创建复杂的图形和效果。你可以在 overlay 选项中编写 TikZ 命令，这些命令会在盒子被绘制的时候执行。

% 注意，overlay 是在盒子的边框之上绘制的，如果你需要在边框之下绘制内容，你可以使用 underlay 选项。

%%%% claude
% tcolorbox包的overlays功能可以用来创建框的覆盖效果。主要特点包括:
% 框可以添加多个叠加层(overlay)。

% 每一层都用一个overlay命令定义。

% 可指定覆盖内容如文本、图片、节点等。

% 支持记号、页码、框标题等自动引用。

% 可相对于框定位,也可用坐标定位置。

% 支持在页边距之外覆盖。

% 可应用于背景、标题等所有元素。

% 可用于创建注释、标注、链接等效果。

% 支持交互操作,如点击显示覆盖。

% 覆盖内容存为独立的图层。

% 可覆盖到别的框形成连接线。

% 提供记忆节点等高级功能。
% 

% gpt
% "Overlay" 在电脑科学和图形设计领域通常被翻译为 "叠加层" 或 "叠加层"。特别是在处理图像、图形用户界面(GUI)和视频编辑等方面，这个词经常被用来描述一种将一个元素、图像或者效果覆盖在另一个之上的技术。

% 在 LaTeX 的 tcolorbox 宏包的上下文中，"overlay" 可以被理解为 "叠加绘制" 或 "覆盖绘制"，表示在盒子的基本内容之上添加额外的图形元素。

% 叠加层
\subsection{Overlays\\叠加层}\label{subsec:overlays}
% \input{coreoptions/叠加层/叠加层_0.tex}
\input{coreoptions/叠加层/叠加层_overlay.tex}



\end{document}

\begin{docTcbKey}{overlay broken}{=\meta{graphical code}}{no default, initially unset}
 If the box is set to be \refKeyLe{/tcb/breakable} and \emph{is} broken actually,
 then the \meta{graphical code} is added to the box drawing process.
 \refKeyLe{/tcb/overlay} overwrites this key.

如果盒子被设置为 \refKeyLe{/tcb/breakable} 并且实际上 \emph{被}打破了， 那么 \meta{graphical code} 将添加到盒子绘制过程中。 \refKeyLe{/tcb/overlay} 将覆盖此键。

% 如果盒子设置为\refKeyLe{/tcb/breakable}且\emph{实际上}分页了,那么\meta{graphical code}会被添加到盒子的绘制过程中。\refKeyLe{/tcb/overlay}会覆盖此项设置。\footnote{译注：即实际上分页时才添加叠加层。}
\end{docTcbKey}

\begin{docTcbKey}{overlay unbroken}{=\meta{graphical code}}{no default, initially unset}
 If the box is set to be \refKeyLe{/tcb/breakable} but \emph{is not} broken actually
 or if the box is set to be \refKeyLe{/tcb/unbreakable},
 then the \meta{graphical code} is added to the box drawing process.
 \refKeyLe{/tcb/overlay} overwrites this key.

如果盒子设置为\refKeyLe{/tcb/breakable}，但实际上\emph{没有}被打破，或者盒子设置为\refKeyLe{/tcb/unbreakable}，则\meta{graphical code}将被添加到盒子绘制过程中。\refKeyLe{/tcb/overlay}将覆盖此键。

% 如果盒子设置了\refKeyLe{/tcb/breakable}但\emph{实际上没}分页，或盒子设置为\refKeyLe{/tcb/unbreakable},那么\meta{graphical code}会被添加到盒子的绘制过程中。\refKeyLe{/tcb/overlay}会覆盖此项设置。\footnote{译注：即实际上没有分页时才添加叠加层。}
\end{docTcbKey}



\begin{docTcbKey}{overlay first}{=\meta{graphical code}}{no default, initially unset}
 If the box is set to be \refKeyLe{/tcb/breakable} and \emph{is} broken actually,
 then the \meta{graphical code} is added to the box drawing process for
 the \emph{first} part of the break sequence.
 \refKeyLe{/tcb/overlay} overwrites this key.

%  如果该盒子被设置为 \refKeyLe{/tcb/breakable} 并且实际上已经被打破， 那么对于断裂序列的 \emph{第一个} 部分，\meta{graphical code} 将添加到盒子绘制过程中。 \refKeyLe{/tcb/overlay} 将覆盖此键。

如果盒子设置了\refKeyLe{/tcb/breakable}且\emph{事实上}分页了，
那么\meta{graphical code}会被添加到盒子的分开的\emph{第一}部分的绘制过程中。
\refKeyLe{/tcb/overlay}会覆盖此项设置。
\end{docTcbKey}

\begin{docTcbKey}{overlay middle}{=\meta{graphical code}}{no default, initially unset}
 If the box is set to be \refKeyLe{/tcb/breakable} and \emph{is} broken actually,
 then the \meta{graphical code} is added to the box drawing process for
 the \emph{middle} parts (if any) of the break sequence.
 \refKeyLe{/tcb/overlay} overwrites this key.

%  如果盒子被设置为\refKeyLe{/tcb/breakable}并且实际上已经被分割， 则\meta{graphical code}将被添加到盒子绘制过程中的\emph{中间}部分（如果有的话）的分割序列中。 \refKeyLe{/tcb/overlay}将覆盖此键。

如果盒子设置了\refKeyLe{/tcb/breakable}且\emph{事实上}分页了，
那么\meta{graphical code}会被添加到盒子的分开的序列中的\emph{中间}部分（如果有）。 \refKeyLe{/tcb/overlay}会覆盖此项设置。
\end{docTcbKey}

\begin{docTcbKey}{overlay last}{=\meta{graphical code}}{no default, initially unset}
 If the box is set to be \refKeyLe{/tcb/breakable} and \emph{is} broken actually,
 then the \meta{graphical code} is added to the box drawing process for
 the \emph{last} part of the break sequence.
 \refKeyLe{/tcb/overlay} overwrites this key.

%  如果盒子设置为 \refKeyLe{/tcb/breakable} 并且实际上已经被打破， 则 \meta{graphical code} 将被添加到盒子绘制过程的最后一个断裂序列的部分中。 \refKeyLe{/tcb/overlay} 覆盖此键。

如果盒子设置了\refKeyLe{/tcb/breakable}且\emph{事实上}分页了，
那么\meta{graphical code}会被添加到盒子的分开的\emph{最后}一部分的绘制过程中。
\refKeyLe{/tcb/overlay}会覆盖此项设置。
\end{docTcbKey}


\begin{docTcbKey}{overlay unbroken and first}{=\meta{graphical code}}{no default, initially unset}
 This is an optimized abbreviation for setting
 \refKeyLe{/tcb/overlay unbroken} and
 \refKeyLe{/tcb/overlay first} together.
 \refKeyLe{/tcb/overlay} overwrites this key.

这是同时设置\refKeyLe{/tcb/overlay unbroken}和\refKeyLe{/tcb/overlay first}的优化缩写。
\refKeyLe{/tcb/overlay}会覆盖此项设置。
\end{docTcbKey}

\begin{docTcbKey}{overlay middle and last}{=\meta{graphical code}}{no default, initially unset}
 This is an optimized abbreviation for setting
 \refKeyLe{/tcb/overlay middle} and
 \refKeyLe{/tcb/overlay last} together.
 \refKeyLe{/tcb/overlay} overwrites this key.

这是同时设置\refKeyLe{/tcb/overlay middle}和\refKeyLe{/tcb/overlay last}的优化缩写。
\refKeyLe{/tcb/overlay}会覆盖此项设置。
\end{docTcbKey}

\begin{docTcbKey}{overlay unbroken and last}{=\meta{graphical code}}{no default, initially unset}
 This is an optimized abbreviation for setting
 \refKeyLe{/tcb/overlay unbroken} and
 \refKeyLe{/tcb/overlay last} together.
 \refKeyLe{/tcb/overlay} overwrites this key.

这是同时设置\refKeyLe{/tcb/overlay unbroken}和\refKeyLe{/tcb/overlay last}的优化缩写。
\refKeyLe{/tcb/overlay}会覆盖此项设置。
\end{docTcbKey}





\begin{docTcbKey}[][doc new=2014-09-19]{overlay first and middle}{=\meta{graphical code}}{no default, initially unset}
 This is an optimized abbreviation for setting
 \refKeyLe{/tcb/overlay first} and \refKeyLe{/tcb/overlay middle} together.
 \refKeyLe{/tcb/overlay} overwrites this key.

这是同时设置\refKeyLe{/tcb/overlay first}和\refKeyLe{/tcb/overlay middle}的优化缩写。
\refKeyLe{/tcb/overlay}会覆盖此项设置。
\end{docTcbKey}

% 这段Latex代码定义了一个新的环境myexample，它是基于tcolorbox的，具有以下特点：
\begin{dispListing*}{breakable,vfill before first,before upper={This example demonstrates
the application of break sequence specific overlay options.
Here, we define an environment |myexample| based
on |tcolorbox| where the visible drawing is done totally by overlay keys.\par
Here, the first application of |myexample| produces an unbroken |tcolorbox|.
The frame is drawn by the code given with \refKeyLe{/tcb/overlay unbroken}.\par
The second application of |myexample| is broken into several parts which
are drawn by the codes given with
\refKeyLe{/tcb/overlay first}, \refKeyLe{/tcb/overlay middle}, and
\refKeyLe{/tcb/overlay last}.
\par\bigskip
}}
    Preamble:
%% \usepackage{tikz,lipsum}
%% \tcbuselibrary{skins,breakable}
%%\newcounter{example}
\colorlet{colexam}{red!75!black}
\newtcolorbox[use counter=example]%%计数器使用example
{myexample}{%
empty,%环境内没有默认文本
title={Example \thetcbcounter},
% 自定义标题：标题格式为Example X，其中X为环境的计数器。
attach boxed title to top left,%标题框线附着在左上角
% 自定义标题框线的样式
boxed title style={empty,size=minimal,toprule=2pt,top=4pt,
    overlay={\draw[colexam,line width=2pt]
    ([yshift=-1pt]frame.north west)--([yshift=-1pt]frame.north east);}},
coltitle=colexam,fonttitle=\Large\bfseries,
before=\par\medskip\noindent,%环境前的文本
parbox=false,%环境内不使用parbox
boxsep=0pt,%边框线与内容的间距为0
left=0pt,right=3mm,top=4pt,
%left=0pt表示左边距为0，right=3mm表示右边距为3mm，top=4pt表示上边距为4pt
breakable,%该环境可以跨页
pad at break*=0mm,%跨页时边框线不需要额外的空白
vfill before first,%第一页时环境顶部需要添加额外的空白。
%接下来，定义了四个tcolorbox中的overlay，
%分别表示未跨页、第一页、中间页和最后一页时边框线的样式。
overlay unbroken={\draw[colexam,line width=1pt]
([yshift=-1pt]title.north east)
%表示标题区域的右上角点，向下移动1pt（点）。
--([xshift=-0.5pt,yshift=-1pt]title.north-|frame.east)
%从标题区域的右上角点，向下移动1pt并向左移动0.5pt（水平方向的一半），再与框架区域的右侧线的交点。
--([xshift=-0.5pt]frame.south east)
% 表示从框架区域的右下角点，向左移动0.5pt，再与上一步得到的交点相连。
--(frame.south west); },
%从框架区域的左下角点，与上一步得到的线条相连。
% 整个绘图过程形成了一个闭合的多边形，线条宽度为1pt（点），
% 颜色为colexam。代码中的overlay unbroken表示这个线条
%会出现在所有页面中，不会被分割。
overlay first={\draw[colexam,line width=1pt]%指定绘制线条的颜色和宽度。
% 在这个例子中，我们将线条颜色设置为“colexam”（可能是在主题中定义的一种颜色），并将线条宽度设置为1个点（pt）。
([yshift=-1pt]title.north east)
%指定线条的起点。在这个例子中，我们将线条起点设置在标题框架的右上角，向下移动1个点（pt）。
--([xshift=-0.5pt,yshift=-1pt]title.north-|frame.east)
% 指定线条从起点到终点的路径。在这个例子中，我们将线条路径设置为从起点沿着标题框架的上边缘向
%右下方偏移0.5个点（pt），然后沿着框架的右边缘向下偏移1个点（pt），直到达到框架的右下角。
--([xshift=-0.5pt]frame.south east); },
% 指定线条的最后一个点。在这个例子中，我们将线条终点设置为框架的右下角向左偏移0.5个点（pt）。
overlay middle={\draw[colexam,line width=1pt] %绘制一条颜色为colexam，线宽为1pt的线条。
([xshift=-0.5pt]frame.north east)
%从框架右上角开始绘制线条，[xshift=-0.5pt]表示将线条向左偏移0.5pt，使得线条在框架内部。
--([xshift=-0.5pt]frame.south east); },
%绘制一条直线，终点为框架右下角，同样向左偏移0.5pt，与上面的线条相连成垂直线条。
overlay last={\draw[colexam,line width=1pt]%绘制一条颜色为colexam、线宽为1pt的线。
 ([xshift=-0.5pt]frame.north east)
% 从frame的东北角向左平移0.5pt作为线的起点
--([xshift=-0.5pt]frame.south east)--(frame.south west);},%
% 从frame的东南角向左平移0.5pt作为线的中间点，最后到frame的西南角作为线的终点。
%因此，这段代码的作用是在frame的右侧绘制一条从顶部到底部的线。
}

\begin{myexample}
\lipsum[1]
\end{myexample}

\begin{myexample}
\lipsum[2-11]
\end{myexample}

\lipsum[12]% following text
\end{dispListing*}
{\tcbusetemp}


\begin{dispExample}
% %% \tcbuselibrary{skins}
%% \newcounter{example}
\newtcolorbox[use counter=example]{FancyTitle}[3][]{%
  enhanced,colback=blue!10!white,colframe=orange,top=4mm,
  enlarge top by=\baselineskip/2+1mm,
  enlarge top at break by=0mm,pad at break=2mm,
  fontupper=\normalsize,label={#3},
  overlay unbroken and first={%
    \node[rectangle,rounded corners,draw=black,fill=blue!20!white,
      inner sep=1mm,anchor=west,font=\small]
      at ([xshift=4.5mm]frame.north west)
         {\strut\textbf{Example \thetcbcounter: #2}};},
  #1}%

\begin{FancyTitle}{My fancy title}{fancy:title}
  \lipsum[1]
\end{FancyTitle}
\end{dispExample}