\usepackage{xparse}
% \usepackage[newfloat,cache=false]{minted} 
\usepackage[newfloat]{minted}
\newminted[tscode]{ts}{autogobble,breaklines}
\newminted[pythoncode]{python}{autogobble,breaklines}
% 让 fancyvrb 确定正在定义的环境的名称

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%python%python%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand\tscodeswitch{%
\renewenvironment{verbatim}{\VerbatimEnvironment\begin{tscode}}{\end{tscode}}
%%%
\RenewDocumentEnvironment{verbatim*}{O{}}
{\VerbatimEnvironment\begin{tscode*}{##1}}
{\end{tscode*}}
%%%
\let\verb\undefined
\newmintinline[verb]{text}{breaklines,breakanywhere}
}

\newcommand\pythoncodeswitch{%
\renewenvironment{verbatim}{\VerbatimEnvironment\begin{pythoncode}}{\end{pythoncode}}
%%%
\RenewDocumentEnvironment{verbatim*}{O{}}
{\VerbatimEnvironment\begin{pythoncode*}{##1}}
{\end{pythoncode*}}
%%%
\let\verb\undefined
\newmintinline[verb]{text}{breaklines,breakanywhere}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%haskellcode%haskellcode%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newminted[haskellcode]{haskell}{autogobble,breaklines,breakanywhere}%,outputdir={/Volumes/RamDisk/haskellcode/}
\newcommand\verbatimSwitchToHaskell{%
\renewenvironment{verbatim}{\VerbatimEnvironment\begin{haskellcode}}{\end{haskellcode}}%


\RenewDocumentEnvironment{verbatim*}{O{}}
{\VerbatimEnvironment\begin{haskellcode*}{##1}}
{\end{haskellcode*}}

% \AfterEndEnvironment{haskellcode*}{\vspace*{-\parskip}}
% \AfterEndEnvironment{haskellcode*}{\vspace*{-\parskip}}

%可以换行的verb
\let\verb\undefined
\newmintinline[verb]{haskell}{breaklines,breakanywhere}

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\newminted[shellcode]{shell}{autogobble,breaklines}
\newcommand\verbatimSwitchToShell{%
\renewenvironment{verbatim}{\VerbatimEnvironment\begin{shellcode}}{\end{shellcode}}%


\RenewDocumentEnvironment{verbatim*}{O{}}
{\VerbatimEnvironment\begin{shellcode*}{##1}}
{\end{shellcode*}}

\AfterEndEnvironment{shellcode*}{\vspace*{-\parskip}}
\AfterEndEnvironment{shellcode*}{\vspace*{-\parskip}}

%可以换行的verb
\let\verb\undefined
\newmintinline[verb]{shell}{breaklines,breakanywhere}

}