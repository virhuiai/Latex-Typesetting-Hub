\chapter{A Building and Developing with Leiningen}
\columnratio{0.55}
\begin{paracol}{2}
Writing software in any language involves generating \emph{artifacts},
which are executable files or library packages that are meant to be
deployed or shared. It also involves managing dependent artifacts, also
called \emph{dependencies}, by ensuring that they're loaded into the
project you're building. The most popular tool among Clojurists for
managing artifacts is Leiningen, and this appendix will show you how to
use it. You'll also learn how to use Leiningen to totally enhancify your
development experience with \emph{plug-ins}.
\switchcolumn
使用任何语言编写软件都涉及生成\emph{构件}，这些构件是可执行文件或库包，用于部署或共享。同时，还需要管理依赖构件，也称为\emph{依赖项}，以确保它们被加载到正在构建的项目中。在Clojure开发者中，最流行的管理构件的工具是Leiningen，本附录将向您展示如何使用它。您还将学习如何使用Leiningen通过\emph{插件}来完善您的开发体验。
%%%%%%%%%%%%%%%%%%%%%
\switchcolumn[0]*
\section{The Artifact Ecosystem}
\switchcolumn
\section{构件生态系统}
%%%%%%%%%%%%%%%%%%%%%
\switchcolumn[0]*
Because Clojure is hosted on the Java Virtual Machine (JVM), Clojure
artifacts are distributed as JAR files (covered in
\href{javascript:void(0)}{Chapter 12}). Java land already has an entire
artifact ecosystem for handling JAR files, and Clojure uses it.
\emph{Artifact ecosystem} isn't an official programming term; I use it
to refer to the suite of tools, resources, and conventions used to
identify and distribute artifacts. Java's ecosystem grew up around the
Maven build tool, and because Clojure uses this ecosystem, you'll often
see references to Maven. Maven is a huge tool that can perform all kinds
of wacky project management tasks. Thankfully, you don't need to get
your PhD in Mavenology to be an effective Clojurist. The only feature
you need to know is that Maven specifies a pattern for identifying
artifacts that Clojure projects adhere to, and it also specifies how to
host these artifacts in Maven \emph{repositories}, which are just
servers that store artifacts for distribution.
\switchcolumn
由于Clojure运行在Java虚拟机（JVM）上，因此Clojure构件以JAR文件的形式进行分发（在第12章中介绍）。Java领域已经有了一个完整的用于处理JAR文件的构件生态系统，并且Clojure也在使用它。\emph{构件生态系统}不是一个官方的编程术语；我用它来指代用于识别和分发构件的一套工具、资源和约定。Java的生态系统是围绕Maven构建工具发展起来的，因为Clojure使用了这个生态系统，您经常会看到对Maven的引用。Maven是一个功能强大的工具，可以执行各种奇怪的项目管理任务。但幸运的是，您不需要在Maven学院获得博士学位才能成为高效的Clojure开发者。您只需要知道Maven规定了一种用于识别构件的模式，Clojure项目遵循这种模式，并且规定了如何将这些构件托管在Maven\emph{仓库}中，这些仓库只是用于存储构件以进行分发的服务器。
%%%%%%%%%%%%%%%%%%%%%
\switchcolumn[0]*
\subsection{Identification}
\switchcolumn
\subsection{识别}
%%%%%%%%%%%%%%%%%%%%%
\switchcolumn[0]*
Maven artifacts need a \emph{group ID}, an \emph{artifact ID}, and a
\emph{version}. You can specify these for your project in the
\emph{project.clj} file. Here's what the first line of
\emph{project.clj} looks like for the clojure-noob project you created
in \href{javascript:void(0)}{Chapter 1}:
\begin{verbatim}
(defproject clojure-noob "0.1.0-SNAPSHOT"
\end{verbatim}
\switchcolumn
Maven构件需要一个\emph{组ID}、一个\emph{构件ID}和一个\emph{版本号}。您可以在\emph{project.clj}文件中为您的项目指定这些信息。以下是在\href{javascript:void(0)}{第1章}中创建的clojure-noob项目的\emph{project.clj}文件的第一行代码：
\begin{verbatim}
(defproject clojure-noob "0.1.0-SNAPSHOT"
\end{verbatim}
\switchcolumn[0]*
clojure-noob is both the group ID and the artifact ID of your project,
and ``0.1.0-SNAPSHOT'' is its version. In general, versions are permanent;
if you deploy an artifact with version 0.1.0 to a repository, you can't
make changes to the artifact and deploy it using the same version
number. You'll need to change the version number. (Many programmers like
the Semantic Versioning system, which you can read about at
\emph{http://semver.org/.}) If you want to indicate that the version is
a work in progress and you plan to keep updating it, you can append
-SNAPSHOT to your version number.
\switchcolumn
clojure-noob是您项目的组ID和构件ID，``0.1.0-SNAPSHOT'' 是其版本号。一般来说，版本是永久的；如果您使用版本号0.1.0将构件部署到存储库中，您不能对构件进行更改并使用相同的版本号再次部署。您需要更改版本号（许多程序员喜欢语义化版本控制系统，您可以在http://semver.org/上阅读相关信息）。如果您想表明版本是一个正在进行中的工作，并且计划继续更新它，您可以在版本号后面添加-SNAPSHOT。
\switchcolumn[0]*
If you want your group ID to be different from your artifact ID, you can
separate the two with a slash, like so:
\begin{verbatim}
(defproject group-id/artifact-id "0.1.0-SNAPSHOT"
\end{verbatim}
\switchcolumn
如果您希望组ID与构件ID不同，您可以使用斜杠将两者分开，如下所示：
\begin{verbatim}
(defproject group-id/artifact-id "0.1.0-SNAPSHOT"
\end{verbatim}
\switchcolumn[0]*
Often, developers will use their company name or their GitHub username
as the group ID.
\switchcolumn
通常，开发人员会使用公司名称或GitHub用户名作为组ID。
\switchcolumn[0]*
\subsubsection{Dependencies}
\switchcolumn
\subsubsection{依赖项}
\switchcolumn[0]*
Your \emph{project.clj} file also includes a line that looks like this,
which lists your project's dependencies:
\begin{verbatim}
:dependencies [[org.clojure/clojure "1.7.0"]]
\end{verbatim}
\switchcolumn
您的project.clj文件还包括以下行，其中列出了您项目的依赖项：
\begin{verbatim}
:dependencies [[org.clojure/clojure "1.7.0"]]
\end{verbatim}
\switchcolumn[0]*
If you want to use a library, add it to this dependency vector using the
same naming schema that you use to name your project. For example, if
you want to easily work with dates and times, you could add the clj-time
library, like this:
\begin{verbatim}
:dependencies [[org.clojure/clojure "1.7.0"]
                [clj-time "0.9.0"]]
\end{verbatim}
\switchcolumn
如果您想使用一个库，可以将其添加到此依赖项向量中，使用与命名项目相同的命名模式。例如，如果您想要轻松处理日期和时间，可以添加clj-time库，如下所示：
\begin{verbatim}
:dependencies [[org.clojure/clojure "1.7.0"]
                [clj-time "0.9.0"]]
\end{verbatim}
\switchcolumn[0]*
The next time you start your project, either by running it or by
starting a REPL, Leiningen will automatically download clj-time and make
it available within your project.
\switchcolumn
下次启动项目时，无论是运行还是启动REPL，Leiningen都会自动下载clj-time，并使其在您的项目中可用。
\switchcolumn[0]*
The Clojure community has created a multitude of useful libraries, and a
good place to look for them is the Clojure Toolbox at
\emph{http://www.clojure-toolbox.com}, which categorizes projects
according to their purpose. Nearly every Clojure library provides its
identifier at the top of its README, making it easy for you to figure
out how to add it to your Leiningen dependencies.
\switchcolumn
Clojure社区创建了大量有用的库，一个好的查找库的地方是Clojure Toolbox网站（http://www.clojure-toolbox.com），该网站根据库的用途对项目进行分类。几乎每个Clojure库都在其README的顶部提供了其标识符，让您很容易找出如何将其添加到Leiningen的依赖项中。
\switchcolumn[0]*
Sometimes you might want to use a Java library, but the identifier isn't
as readily available. If you want to add Apache Commons Email, for
example, you have to search online until you find a web page that
contains something like this:
\begin{verbatim}
<dependency>
    <groupId>org.apache.commons</groupId>
    <artifactId>commons-email</artifactId>
    <version>1.3.3</version>
</dependency>
\end{verbatim}
\switchcolumn
有时，您可能想使用一个Java库，但标识符不容易找到。例如，如果您想要添加Apache Commons Email库，您必须在网上搜索，直到找到一个包含以下内容的网页：
\begin{verbatim}
<dependency>
    <groupId>org.apache.commons</groupId>
    <artifactId>commons-email</artifactId>
    <version>1.3.3</version>
</dependency>
\end{verbatim}
\switchcolumn[0]*
This XML is how Java projects communicate their Maven identifier. To add
it your Clojure project, you'd change your :dependencies vector so it
looks like this:
\begin{verbatim}
:dependencies [[org.clojure/clojure "1.7.0"]
                [clj-time "0.9.0"]
                [org.apache.commons/commons-email "1.3.3"]]
\end{verbatim}
\switchcolumn
这个XML是Java项目用来传达它们的Maven标识符的方式。要将其添加到您的Clojure项目中，您需要更改:dependencies向量，使其如下所示：
\begin{verbatim}
:dependencies [[org.clojure/clojure "1.7.0"]
                [clj-time "0.9.0"]
                [org.apache.commons/commons-email "1.3.3"]]
\end{verbatim}
\switchcolumn[0]*
The main Clojure repository is Clojars (\emph{https://clojars.org/}),
and the main Java repository is The Central Repository
(\emph{http://search.maven.org/}), which is often referred to as just
\emph{Central} in the same way that San Francisco residents refer to San
Francisco as \emph{the city}. You can use these sites to find libraries
and their identifiers.
\switchcolumn
主要的Clojure仓库是Clojars（https://clojars.org/），主要的Java仓库是中央仓库（http://search.maven.org/），通常被称为“中央仓库”，就像旧金山居民称旧金山为“这个城市”一样。您可以使用这些网站来查找库和它们的标识符。
\switchcolumn[0]*
To deploy your own projects to Clojars, all you have to do is create an
account there and run lein deploy clojars in your project. This task
generates everything necessary for a Maven artifact to be stored in a
repository, including a POM file (which I won't go into) and a JAR file.
Then it uploads them to Clojars.
\switchcolumn
要将自己的项目部署到Clojars，您只需在该网站上创建一个帐户，并在项目中运行“lein deploy clojars”命令。这个任务会生成一切必要的东西，用于将Maven构件存储在仓库中，包括一个POM文件（我不会详细介绍）和一个JAR文件。然后将它们上传到Clojars。
\switchcolumn[0]*
\subsubsection{Plug-Ins}
\switchcolumn
\subsubsection{插件}
\switchcolumn[0]*
Leiningen lets you use \emph{plug-ins}, which are libraries that help
you when you're writing code. For example, the Eastwood plug-in is a
Clojure lint tool; it identifies poorly written code. You'll usually
want to specify your plug-ins in the file
\emph{\$HOME/.lein/profiles.clj}. To add Eastwood, you'd change
\emph{profiles.clj} to look like this:
\begin{verbatim}
{:user {:plugins [[jonase/eastwood "0.2.1"]] }}
\end{verbatim}
\switchcolumn
Leiningen允许您使用插件，这些插件是帮助您编写代码的库。例如，Eastwood插件是一个Clojure代码检查工具，它可以识别编写不良的代码。通常，您会在文件``\emph{\$HOME/.lein/profiles.clj}''中指定您的插件。要添加Eastwood，您可以将“profiles.clj”更改为以下内容：
\begin{verbatim}
{:user {:plugins [[jonase/eastwood "0.2.1"]] }}
\end{verbatim} 
\switchcolumn[0]*
This enables an eastwood Leiningen task for all your projects, which you
can run with lein eastwood at the project's root.

Leiningen's GitHub project page has excellent documentation on how to
use profiles and plug-ins, and it includes a handy list of plug-ins.
\switchcolumn
这样，您就可以在项目的根目录中使用“lein eastwood”命令运行eastwood Leiningen任务。

Leiningen的GitHub项目页面提供了关于如何使用配置文件和插件的优秀文档，并且还包括一个方便的插件列表。
\switchcolumn[0]*
\subsubsection{Summary}
\switchcolumn
\subsubsection{小结}
\switchcolumn[0]*
This appendix focused on the aspects of project management that are
important but that are difficult to find out about, like what Maven is
and Clojure's relationship to it. It showed you how to use Leiningen to
name your project, specify dependencies, and deploy to Clojars.
Leiningen offers a lot of functionality for software development tasks
that don't involve actually writing your code. If you want to find out
more, check out the Leiningen tutorial online at\\
\emph{https://github.com/technomancy/leiningen/blob/stable/doc/TUTORIAL.md/}.
\switchcolumn
本附录重点介绍了项目管理的重要方面，例如Maven是什么以及Clojure与Maven的关系。它向您展示了如何使用Leiningen为您的项目命名，指定依赖项并部署到Clojars。Leiningen提供了许多与软件开发任务相关的功能，而不仅仅是编写代码。如果您想了解更多信息，请查看Leiningen在线教程，网址为\\
\emph{https://github.com/technomancy/leiningen/blob/stable/doc/TUTORIAL.md/}。
\end{paracol}
